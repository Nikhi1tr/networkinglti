                                                                          22/07/2024
                                                                CREATE VIRTUAL MACHINE ON HYPER V

OS Types
--------------
Client OS
-> Perform basic Operation
-> End user application
E.g. Windows 11

Server OS
-> We choose depending on weight (resources they use)
Eg: Ubuntu 

Embedded OS
phone, smart watch

Who authenticates the user password on a stand alone system?
Authentication is for 
Authorization Checking for privileges

What does your refresh button do in your system?
OS services load and then application services load
It removes any unwanted junk that stores from ram during startup

Virtualization that deals with logic 
Hypervisors
Type1 Hypervisor (BareMetal Hypervisor)
Type2 hypervisor (Hosted Hypervisor)

Hyper-V is both Type1 and Type2

To open Hyper-V -> Wind+r -> virtmgmt.msc

Import VM -> Any existing machine we can connect

3 types of network
1. internal
2. private
3. external



VM1 VM2(private)     These cant communicate with our host
VM3 VM4 (Internal)   These systems can communicate among themselves and they can communicate with the host
VM5 VM6 (external)   These can access internet and 

Create VM
-------------------
Create path to store VM
New-> create Vm -> / -> create folder in c drive -> inside that 2 folder (VM and Hard disk)

Virtual switch manager-> private -> name -> create -> browse -> select the folder -> Gen1 or Gen2 (gen1) ->
In dynamic memory it utilizes min memory to boot up, in 10GB ram 4GB is allocated to VM , in host if the 6gb ram is done and it requires more ram then it pulls back the 4GB ram from 


network -> private switch -> hard disk -> install os later -> create

hard disk is also dynamic and it has 3 types
dynamic
thick sized
differencing

2 extensions vhd and vhdx(vhd 2TB and vhdx 16)

OS Installation
----------------
Connect -> file -> media -> dvd drive -> insert -> open
       or
file -> settings -> dvd  drive

Start process
--------------------
start -> repair or install (install) -> custom or upgrade(custom) -> partition (if we don't do entire storage will go under  c drive) -> installation starts





*********************************************************************************
Setup Dc server
------------------
1. create Vm
2. Select Os
3. Select data center edition with windows feature
4. custom

client  Nikhil          123456
dc      Administrator   Nikhil@123456
svr1    Administrator   Nikhil@123456 


 SUMMARY:
  -> Created a private network
  -> Downloaded OS client and OS Server
  -> Created 3 Vm's on our local machine (DC, client, svr1)
------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                             23/07/2024
                                                PROMOTE VM TO DOMAIN CONTROLLER AND ADD USER

Connect to DC -> Server Manager -> 
1)
-- Roles are services that you would like to host on server
-- Features includes dependencies and management tools for the roles
-- Roles are dependent on features whereas features are no dependent on roles
2)
-- Add other server to
-- connect multiple servers for working
3)
-- Create a new group
-- We can group the servers like DHCP servers, DNS servers etc.
4)
-- Connect server to cloud server
-- If we are having servers on cloud we can connect to them using this
5) Local Server
 -> Refresh: Default time server refresh is 10min, so to immediately view them 
     -- Black Notification: The process is completed
     -- Yellow Notification: Configurations is required
     -- Red notification: Immediate action is required(Failure or alert notifications)
 -> Manage:
 -> Tools: All administrative tools is available here
 -> View: How you want your dashboard to look
 -> Help:   
 -> Computer Name:
    -> It will be IND-BLR-Whitefield-rackname-web1
    -> To change the computer name: click, change, name, restart
 -> WORKGROUP:
    -> Every user will be administrator of the system
    -> No centralized management
 -> DOMAIN 
    -> we will be having centralized management, every min ute operations(like disabling refresh) can be controlled
    -> Domain is a logical boundary(Its virtual thats why it is not physical)
 -> Ethernet
    -> To check ip address, ethernet click -> Ethernet -> details
    -> This Ip address in known as APIPA (automatic private internet protocol address) 
    -> The APIPA range starts with 169 
    -> The APIPA range in IPV6 starts with fe80
 -> Assign Ip
    -> Select ethernet -> properties -> ipv4 -> properties -> assign by us -> 192.168.1.1(No prod server will have 1)
    -> Default gateway: Any packet that goes or comes is gateway
    -> DNS Server : same as ip

Domain OS
-------------
 -> Server OS (Only server OS is required)
 -> Valid name(Optional)
 -> valid ip(Static IP), DNS assigned to it
 -> ADDS Role has to be installed(Active Directory Domain Service)
 -> Promote to domain controller
 -> dcpromo.exe (Domain Control Promotion)(It checks adds is installed or not, it will take you to configure state, if not install it will install adds role and then take to configuration) This command is not supported from 2012.
 -> Administrator must have complex password
  
  -> To install ADDS
    -> Dashboard , add roles and machine, select role based
    -> There are total 23 roles
    -> Select ADDS
    -> next and install
    -> yellow flag (Conf required)

    Domain Controller
    -----------------
    machine that hosts and controlls the domain(centralized management system with a logical boundary) 

  -> Click on flag, promote it to dns server
  -> Select 
      1. when we are preparing secondary domain
      2. lti.com is a forest, if we want to create finance.lti.com we choose 2nd option
      3. first or primary setup
  -> Select new forest -> root name(no special char and no space)
  -> If Forest functional level 2016 then min level for domain functional level (2016,2022,..... )
  -> forest and domai level can only be increased and cannot be decreased
  -> GC(Global Catalog) is the index of your forest
  -> Every forest must have GC
  -> RODC(Read Only Domain Controller)
  -> Password of domain that is getting created  
     -> Security of domain
     -> if dc got crashed, or if you have deleted a user, so for backup we use dsrm mode password
  -> NetBIOS domain is the name of your domain without TLD
  -> Paths will always be in different drive because when os crashes everything will be gone
  -> AD is the centralized management console for domain objects

 -> FQDN(Fully Qualified Domain Name)
   -> dc.applicat.online
   -> dc is NetBIOS name of computer
   -> applicat is NetBIOS name of domain
   -> com tld name
   -> applicat.online is fqdn of domain
   -> dc.applicat.online is fqdn of computer
   -> server manager -> tools -> users and .. or  win+r dsa.msc(domain service administration. Microsoft service console)
   -> all the files will be in c drive , windows, ntds, ntds.dit


Client VM
----------
win+r -> ncpa.cpl -> ip -> select -> properties -> 192.168.1.10 -> DNS -> 
this pc -> left click -> properties -> change settings -> change -> name of client -> domain -> domain name(applicat.online) -> go to dc -> server manager -> tools -> ad users 
After restart -> administrator@applicat.online -> password

Create users on dc
---------------------

open ad -> dsa.msc -> users -> left click -> new -> user -> create new ->name and last name(Nikhil) -> logon name(10760532@applicat.online)-> pwd -> user  1. user need to change after login
2. cant change
3. pwd expires (42 days)
4. disable   

Assignment
---------------
How to create group in ad and add users to the group
How to create organizational units(OU) (ad-> right click on domain ctrlr -> then create)
Difference between ou and container in ad
containers are default objects that provide a basic hierarchical structure for organizing objects in Active Directory.
OU is a special container in ad, which contain objects
What is fsrn and why it is used

SUMMARY
 -> Assign static ip, assign valid name, install adds, promote the dc server to ADDS controller(applicat.online) 
 -> Assign static ip to client and add the server to domain of ad(applicat.online)

------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                                24/07/2024
Assignment 
Purpose of each and every tab of user
What is multicast scope in DHCP Server
If DNS is there why do we need Win Server
How to backup and restore dhcp server

FSMO(Flexible Single Master Operations)
-> Even 1 fsmo goes down, the domain will be mall function. Mall function depends on which role went down
-> To check all FSMO (Power shell, netdom query fsmo)
 

1. Schema Master
  -> When an object is created, the index/schema has to be updated. It updates that
  -> when this goes down, the user will be created but the entry will not be there 

2. Domain Naming Master
  -> To make sure every domain name created inside the forest , that domain is unique
  -> 

3. RID Master  (Relative Identifier)
  -> If this goes down, users, group or any object cannot be created
  -> Any point of time object gets created it assigns SID
      -> Security Identifier
      -> 96 Bits
      -> SID is unique only within a domain
  -> By default 500 SID's are created when a domain is created

4. PDC Emilator (Primary Domain Controller)
   -> Authentication for users
   -> Time Synchronization

5. Infrastructure Master
   -> Whenever you move an object from one OU to another OU or from one domain to another domain, it tracks all the movement of these.
   -> If this fails user is moved from one Ou to another , the policies doesn't get updated

Power shell, netdom query fsmo
If there are secondary domains, all these files will be on 1 system or 1 Domain Controller, we can distribute these files on all the files.

SID
---
AD -> view -> advanced features -> users -> properties -> attributes -> Filter -> Show value with attributes -> object sid

S          -> Defines SID
1          -> Version of SID
5          -> this defines authentication methods (Differs between 1 to 13) (most of the times it is 5)
21         -> this defines group identity (which group user belongs to)
3 fields   -> Domain Identifier 
last fiels -> Relative Identifier

Default SID of DC -> S-1-.......-500
No object in a domain exist without SID

GUID
-----
If 2 domains merge lti and mindtree (both have 500 sid)
so GUID is globally unique
No object in a domain exist without GUID

DHCP
-------
1. Discover
  -> Client to server
  -> E.g. Search for flat

2.Offer
 -> It has details which ip are available 
 -> Servr to client
 -> E.g. discuss rent from owner\

3. Request
 -> Client to server
 -> E.g. client should send

4. Acknowledge
 ->Server to client
 -> it sends ipv4, ipv6, dns, lease
 -> while the lease time is getting to be gone, only request and acknowledge hapens 

Exclusive Range
 -> This ip address will be reserved and will not be allocated to anyone, it is used for future purpose and all
 -> E.g. Owner reserves from flat , and cannot give them for rent 
 -> Scope is the pool of ip address

Ip reservation
 -> We reserve ip address permanent for the system
 -> If a system connects it gets a ip1, it disconnects for 20 days, again if system connects ip1 should be allocated
 -> 
Default lease time is 8 days

DHCP ON DC
--------------

Server Manager -> Install DHCP server -> Yellow Flag -> Configure 
 -> Authorizing DHCP -> Next -> Commit
 -> Tools -> DHCP -> If the IPv4 and Ipv6 are red or question mark -> Configure is not done
 -> Ipv4 -> right click -> new scope -> name and description 	-> next -> start (192.168.1.11) -> end (192.168.1.15)
 -> subnet delay (0) -> Lease duration -> Router (192.168.1.1) -> next -> domain -> 
 -> scope(until and unless we activate scope, ip address will not be released) -> Finish
 
Login to client vm -> admin@app.oneline -> ncpa.cpl -> assign auto ip -> close -> cmd -> ipconfig -> ipconfig /all -> lease and all details
Login to DC -> check in lease
To reserve -> reserve the ip on right click

dc -> address pool right click -> new exclusion (192.168.1.11 to 192.168.1.15)
client -> Forecefully do the lease -> ipconfig /release -> ipconfig -> ipconfig /renew -> 


Failover(If DC fails)
-----------------------------

svr1 -> 192.168.1.2 -> name -> join to domain (applicat.online) ->
login as administrator->  install dns server and dhcp -> configure

dc -> dhcp server -> right click on scope -> failover -> next -> select -> svr1 -> max client lease time (if primary fails , for how long second should be there) -> mode (load balance/hot standby) hot standby(it will be idle until and unless primary fails) -> active or standby(active means ram and processor will be occupied if it is in standby minimal resource will be utilized) -> state switchover interval(if 1ry goes down this will be 1ry, when 1ry is back it goes) -> finish

dc -> name right click -> stop

client vm -> ipconfig /release -> ipconfig /renew -> ipconfig /all (This will be attached by DHCP server 2)

Deny Ip allocation
-------------------
Lease -> ip address -> right click -> deny
filters -> deny -> right click -> enable 
To allow it back -> delete from deny list -> 


Secondary DNS Server
-----------------------

Make svr1 as secondary DNS Server
Have proper name, static ip , adds
Install adds to svr1 -> all servers -> add server -> svr1 -> ok
Add roles and features-> next -> next -> select svr1 -> install adds -> promote -> first option -> name -> select -> additional options
 -> from which domain it should get replicated -> install
Login to svr1 -> check it has replicated or not


Summary:
 -> FSMO Files (Schema MAster, Domain name Master, RID Master, PDC Emulator, Infra Master) Powershell(netdom query fsmo)
 -> SID 
 -> DHCP Server Install and configure to make it run
 -> client vm got ip assigned by DHCP(exclusion)
 -> set up svr1 as secondary domain controller(if dc gets failed,svr1 will assign ip)
 -> Allow and Deny ip allocations
 -> Install ADDS on svr1 using DC

------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                               25/07/2024

What is difference between compute config and user config policies
FSRM(File Source Resource Manager): Mapping a drive to user profile
Host web server with https
create one more client and server

User 1 in DC , folder in DC(F) , file named usr
User1 logs in to access th file , he uses unc path,  \\192,168.1.1\F\usr

Share folder -> we access the folder through UNC Path

Create a New HardDisk -> On HyperV -> New -> HD -> name -> path -> create
Select Dc -> Shutdown -> select dc ->  Settings -> add a new disk -> browse -> give the path -> create

Connect to DC -> diskmgmt.msc -> new partition -> format -> add disk -> Go inside the drive -> Create a folder and share -> share with people -> find people -> 

On Client -> Run prompt -> //DC/User1_Folder

Everytime user wants to access the files, 
If we map from user , only on this machine will be there and not on others

On DC -> user1 -> properties -> profile -> connect -> Z -> \\DC\User1_Folder(FolderName)
If we map D drive which is already there in local VM  , then preference will be for local machine. So we go from z

Signout and sign in -> File will be there

Try to login user1 on svr1 -> error(No user can login to domain controller) -> So we give him permissions -> Dc -> user1 -> properties -> members of -> add -> admin -> check names -> apply -> ok -> login user2 on svr1 -> check

create a new folder at dc and attach the same for user2 and check

E drive is there (128GB)-> user1 folder uses 128(GB) -> user2 folder can also use (128GB) -> soo server crashes
thats why in fsrm we can provide  limit for user1 (2GB) and for user 2(3GB)
for this we use hard quota and soft quota 

 1.Hard Quota
   -> if 1 Gb hard quota is allocated to user1 he cannot exceed them.
 2.Soft Quota
  -> admin dont know whether to provide 1GB or 2GB , he provides soft quota
  -> it is used for monitoring
  -> the user uses some data for 3 months, take the average of storage 


File Screening
when user is trying to copy files , it verifies if the file format is allowed or not allowed.
Same concept we have under file screening

 1.Active File screening (like hard)
   ->png file cannot be downloaded

 2.Passive File Screening(like soft)
   -> png can be downloaded but with warning

DC-> server manager -> files dropdown -> drop down -> install
Tools -> FSRM -> quota -> quota template -> create new -> hard quota 1(10kb) -> threshold means (notifications for 80% on email)
create one more as soft quota(10kb of soft)

Tools -> FSRM -> FileScreen -> create a template (active and passive) -> limit txt and html
Create -> file screen -> select folder and template -> save and check inside user1 and user2

File Management tasks ->if user still creates txt or html , we can create like the file will automatically get deleted after some time -> user created a file1.txt in night -> morning it will be deleted 



Group Policies
--------------

Security admin need to delete 

-> Each and every operation can be controlled of user, even the right click can be disallowed
-> By default, there is policy called default domain policy
-> 2 Consoles
  1. GPMC (group policy management console)
  2. GPME (group policy management editor)
-> creation need to do from gpmc to which user gpmc
-> gpme configure settings inside the policy
-> In server 2008 it takes 24 hrs to update policies
-> after that it takes 90-120 min
-> gpupdate
-> admx templates
-> These are stored in sysvol

DC-> Server Manager -> Tools -> GPMC ->default policies -> edit -> security settings -> account policies -> Password policy -> enforce policies -> doble click -> max pwd age (reset pwd after) ->  min pwd age (what happens it is zero?) -> 

Account Lockout Duration
 1. Account Lockout Duration(If user enters wrong pwd
 2. Account lockout threshold( User provide wrong pwd for 3 times)
 3. 

It takes time to update policy -> gpupdate /force -> login to usr2 -> enter wrong pwd -> it gets blocked for 30min -> to disable this time immediately ->
user ->  properties -> account -> uncheck the box

To display a starting message 
edit -> security settings -> local policies -> security options -> Interactive logon(message replication) 
client -> restart -> it will pop up


------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                              26/07/2024
Assignment
----------
1. While creating the hard disk, what and all options come. Explore?
2. Raid 0, Raid 1, Raid 5, Raid 0+1, Raid 1+0
3. What are malwares and threats, windows defender, How to protect from malware and threats using windows defender
4. what are the protocols used by active directory
5. How to monitor client OS(windows 10/11)
6. 

Connection 
 -> Connecting DC, ADC, ADC1

Change
 -> User 1 is created in DC, (any object created )

Notification
 -> If the change is happened in dc, adc1 and adc2 dont know, to make them aware

Wherever the change has occurred that is called is called upstream partner
Wherever the change is getting sent is called downstream partner

AD replication agent (change notification is sent to ADC1 , then it activates ad replication agent, this pulls the changes from dc)
DC change 

KCC(knowledge consistency checker)
 -> Generating Replication Topology
 -> It runs automatically for every 45min
 -> If any link is broken , it regenartes the topology connections

Polling
 -> Connection between DC and ADC is cut(network wire break)
 -> It sends polling to ADC1 and get response from DC



we have 2 forest lti and mindtree

we have 2 types of trust
Transitive
-> One way trust (one person is trusting , one way love)
-> Two way trust (Both of them is trusting)

Non Transitive


Create a new forest mindtree.com -> promote to dc ->
Dc1 -> ad
Active dir. domain & trusts -> domain RC -> properties -> Name of the domain we want to connect -> Transitant trust -> 2nd opt. (this domain only) -> user name & pwd. of mindtree domain -> forest wide authentication - > same forest wide -> next -> next -> Finish
 
Open DNS -> Fwd. lookup zone -> Next -> Stub zone -> 2nd option -> Name of other domain (which we want to connect) -> DNS is running on DC so give IP of DC2 -> Finish
 
Create an user in 2nd domain -> client m/c -> try logging in 1st domain with that user (user@mindtree.com or mindtree\user)  -> mindtree
 
*How to check replicant. done?
 
In Fwd. Lookup zone -> Open 1 domain -> entry will be avail.
 
*Not all details will be replicated only DNS details will be available.
------------------------------------------------------------------------------------------------------------------------------------------------------------
                                                           27/07/2024
1. What do you means by delegated administrator
2. what is event viewer and why do we use it
3. 

Install an OS on 1 machine take 30min with 1 pendrive, what to do for 1000 machines with one 1 drive?

That's why WDS (Windows Deployment Services)
 -> when a system is on it checks for os inside and then it goes to wdc and fetches OS
 -> WDC is there, clients are not having ip address so there is a server in middle called dhcp to provide ip
 -> 


Install WDs -> tools -> wds -> next -> 3rd option no checkbox -> finish
right click on dc -> start -> browse -> this pc (down) -> dvd drive -> sources -> install.wim -> select -> uncheck everything except last one -> finish

install boot image
right click -> add image -> browse (boot.wim) -> name cannot define which os(client or os) -> so change name to windows server 2016 -> finish

install tftp
scope options on dhcp -> right click -> configure -> 66(check box) -> ip of dc on string -> finish

create new vm to check
---------------------
vm -> create -> in os tab -> select last option ->
we need to press f12 or
wds -> right click on dc.applicat.online -> properties -> boot -> always allow pxe 


Mail ExchangeServer

-> download exchange server -> dc -> increase ram to 8gb -> add iso file from dvd drive -> apply ok 
connect to vm -> this pc -> exchange server -> scroll down to last -> exchange server -> doubleclick

connect to vm -> this pc -> exchange server -> scroll down to last -> setup -> mailbox (check box) -> malware protection(yes , as this is lab setup) -> errors -> create a new external switch -> turn off dc -> add external switch -> attach to vm -> errors, install all packages -> after all the installation are done -> delete that svr1 -> in adds computer


------------------------------------------------------------------------------------------------------------------------------------------------------------                          
                                                                      29/07/2024 

1. Delegate control to group
2. Delegate control to user
3. How to transfer fsmo role uing cli
4. Create user, groups, add user to groups, create OU using powershell

after installing -> exchange administrative server -> advanced -> load -> administrator@abc.com -> pwd -> Add(+) -> name -> browse (user1) -> create 
do it for user2 also

login to client -> https//localhost (Browse) -> name -> pwd -> send a mail to user2 -> login to user2 mail and check

Problem is security
DC -> accepted domains(only from this domain you can send or receive mails) ->  + -> add rules -> add words ->  redirect the message to -> select admin -> ok -> 

Send a mail from user1 to user2 with that keys -> it wont be received by use2 -> the mail will be sent to admin

Compliance management -> groups (if you send mail to hr@lti.com , this goes to entire hr) -> 

start -> event viewer -> 

delete user 1 in ad 
Objects deleted from ad and still available in database for 90 days are called tombstone or lingering base
AD administrative center -> abc.com -> enable recycle bin -> 
on AD administrative center both forest and domain functional level can be raised 

now delete user2 in ad 
now on ad administrative user2 will be there


WSUS(Windows Service Update Server)
-----------------------------------------

-> When we do update , the system will go to wsus server 
-> admin has ctrl of all updates
-> bandwidth utilization is low
-> no system is directly being exposed


